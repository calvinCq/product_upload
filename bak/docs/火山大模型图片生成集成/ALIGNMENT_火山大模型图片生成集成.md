# 火山大模型图片生成集成 - 需求对齐文档

## 原始需求
用户要求接入火山大模型进行商品图片生成，具体需求为：
- 调用火山大模型生成商品图片
- 需要根据客户输入的内容生成图片
- 生成3张主图和2张详情图
- 将生成的图片接入到现有的商品上传流程中

## 边界确认

### 任务范围
- 实现火山大模型API调用模块
- 实现图片生成与管理功能
- 修改商品上传流程，集成图片生成功能
- 确保生成的图片符合微信小店要求

### 非任务范围
- 不修改现有微信小店API的核心功能
- 不负责火山大模型API密钥的申请和管理
- 不包含复杂的图片后处理功能（如裁剪、滤镜等）

## 需求理解

### 对现有项目的理解
1. **项目架构**：
   - 项目使用Python实现微信小店商品上传功能
   - 包含图片上传、商品添加、批量上传等核心功能
   - 主要文件包括 `wechat_shop_api.py`、`product_uploader.py` 等

2. **图片上传流程**：
   - 当前支持从本地文件上传图片到微信小店
   - 使用 `upload_image` 方法上传图片，返回图片URL
   - 图片要求：JPG/PNG格式，主图建议800x800像素，大小不超过1MB

3. **商品上传流程**：
   - 支持视频号小店和传统微信小店两种模式
   - 需要提供商品图片、标题、描述、价格等信息
   - 商品数据中包含图片URL列表

### 需要新增的功能
1. **火山大模型调用模块**：
   - 实现火山大模型API的调用功能
   - 支持根据文本描述生成图片
   - 管理API密钥和请求参数

2. **图片生成管理**：
   - 生成3张主图和2张详情图
   - 保存生成的图片到本地临时目录
   - 确保图片格式和大小符合微信小店要求

3. **与商品上传集成**：
   - 在商品上传前自动生成所需图片
   - 将生成的图片上传到微信小店并获取URL
   - 将图片URL添加到商品数据中

## 疑问澄清

### 待确认事项
1. **火山大模型API详情**：
   - 具体使用哪个火山大模型的图片生成API？
   - API的具体参数和返回格式是什么？
   - API密钥如何管理（是否使用.env文件）？

2. **图片生成要求**：
   - 主图和详情图的具体尺寸要求是什么？
   - 图片风格、背景等是否有特定要求？
   - 生成图片的保存位置和命名规则

3. **用户交互流程**：
   - 用户如何输入商品描述内容？
   - 是否需要预览和选择生成的图片？
   - 是否需要提供重生成功能？

### 假设条件
在没有更多信息的情况下，我们做出以下假设：
1. 火山大模型API支持通过HTTP请求调用
2. API需要API密钥进行身份验证
3. 生成的图片默认格式为JPG，大小不超过1MB
4. 图片生成后保存在本地临时目录，然后上传到微信小店
5. 用户将通过命令行或配置文件输入商品描述内容

## 下一步计划
1. 创建详细的架构设计文档
2. 实现火山大模型API调用模块
3. 实现图片生成与管理功能
4. 修改商品上传流程，集成图片生成功能
5. 编写测试和示例代码
6. 更新相关文档