# 教育培训商品详情生成 - 共识文档

## 明确的需求描述

### 核心功能
1. **教育培训商品详情生成器**：根据客户资料，生成符合微信小店教育培训类目规则的商品详情文案
2. **五部分结构内容**：自动生成以下五个部分的文案内容
   - 标题
   - 老师简介
   - 课程大纲
   - 适用人群
   - 学完收获
3. **敏感词过滤**：确保生成的内容不包含指定的敏感词列表中的词语
4. **商品添加测试**：集成现有商品上传功能，测试生成的详情是否可以成功添加到微信小店

### 输入输出规范

#### 输入
- **客户资料**：包含但不限于以下字段的JSON对象
  - 课程名称/主题
  - 主要授课老师信息
  - 课程主要内容
  - 目标受众
  - 预期学习成果
  - 课程特色

#### 输出
- **结构化商品详情**：JSON对象，包含五个主要字段和对应内容
- **状态信息**：生成是否成功、错误信息（如有）
- **敏感词检查报告**：识别到的潜在敏感词

## 技术实现方案

### 1. 模块设计

#### 教育培训详情生成器模块（education_product_generator.py）
- 核心功能：生成符合规范的商品详情
- 主要类：`EducationProductGenerator`
- 关键方法：
  - `__init__()`：初始化生成器，加载配置
  - `generate_details(client_data)`：生成商品详情
  - `filter_sensitive_words(text)`：过滤敏感词
  - `validate_details(details)`：验证生成内容的完整性

#### 敏感词过滤器模块（sensitive_word_filter.py）
- 核心功能：敏感词检测与替换
- 主要类：`SensitiveWordFilter`
- 关键方法：
  - `__init__(words_list)`：初始化敏感词列表
  - `contains_sensitive(text)`：检查是否包含敏感词
  - `filter_text(text)`：过滤敏感词（替换或删除）

### 2. 集成方案

#### 与现有系统集成
- 复用现有的`product_with_image_generator.py`中的商品上传功能
- 新模块生成的详情内容可作为输入传递给现有上传功能

#### 配置管理
- 敏感词列表可通过配置文件管理
- 支持从环境变量或配置文件加载设置

## 技术约束

### 1. 微信小店规则遵循
- 生成内容必须符合微信小店教育培训类目的审核规范
- 不得包含虚假宣传、误导性内容
- 价格、课时等信息必须明确且合理

### 2. 数据安全
- 客户资料必须安全处理，不得泄露
- API密钥等敏感信息使用环境变量管理

### 3. 性能要求
- 单次详情生成时间不超过3秒
- 支持批量生成，批量处理10条数据不超过30秒

## 任务边界限制

### 包含范围
- 教育培训类目商品详情的文本内容生成
- 敏感词过滤和检查
- 基本的商品添加测试

### 排除范围
- 图片生成（使用现有图片生成功能）
- 其他类目的商品详情生成
- 完整的商品上架和运营流程
- 第三方支付集成

## 验收标准

### 功能验收
1. **生成完整性**：成功生成包含5个部分的商品详情内容
2. **敏感词过滤**：生成内容中不包含指定的敏感词列表中的任何词语
3. **格式规范**：输出格式符合要求，可直接用于商品上传
4. **商品添加测试**：能够成功调用商品添加API，返回成功状态

### 性能验收
1. **响应时间**：单次生成时间<3秒
2. **错误率**：生成错误率<1%
3. **稳定性**：连续运行100次无崩溃

### 质量验收
1. **内容质量**：生成内容通顺、符合逻辑、具有吸引力
2. **规范符合性**：符合微信小店教育培训类目的审核要求
3. **代码质量**：代码结构清晰、有适当注释、遵循PEP8规范

## 关键假设确认

1. **客户资料格式**：假设客户资料将以JSON格式提供，包含必要的关键字段
2. **现有系统集成**：假设现有商品上传模块可以正常工作，并且提供适当的接口
3. **API可用性**：假设微信小店API和火山大模型API可以正常访问
4. **敏感词列表**：假设提供的敏感词列表是完整和准确的，可根据实际情况调整

## 风险评估

### 潜在风险
1. **审核失败**：生成内容可能因未预见的原因导致微信小店审核失败
   - **缓解措施**：建立审核失败日志，定期更新生成规则

2. **客户资料不完整**：输入的客户资料可能缺少必要信息
   - **缓解措施**：实现数据验证，提供清晰的错误提示

3. **API限制**：微信小店API可能有调用频率限制
   - **缓解措施**：实现错误重试和限流机制